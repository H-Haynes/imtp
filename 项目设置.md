# IMTP Monorepo é¡¹ç›®è®¾ç½®å®Œæˆ

## ğŸ‰ é¡¹ç›®å·²æˆåŠŸåˆ›å»ºï¼

æ‚¨çš„IMTP monorepoé¡¹ç›®å·²ç»è®¾ç½®å®Œæˆï¼ŒåŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

### âœ… å·²å®Œæˆçš„åŠŸèƒ½

1. **Monorepoç»“æ„**
   - ä½¿ç”¨pnpm workspacesç®¡ç†å¤šä¸ªåŒ…
   - ç»Ÿä¸€çš„ä¾èµ–ç®¡ç†å’Œæ„å»ºæµç¨‹

2. **ç°ä»£åŒ–æ„å»ºç³»ç»Ÿ**
   - Vite + TypeScripté…ç½®
   - æ”¯æŒCommonJSå’ŒESMåŒæ ¼å¼è¾“å‡º
   - è‡ªåŠ¨ç”Ÿæˆç±»å‹å®šä¹‰æ–‡ä»¶

3. **å®Œæ•´å¼€å‘å·¥å…·é“¾**
   - TypeScriptæ”¯æŒ
   - ESLintä»£ç æ£€æŸ¥
   - Prettierä»£ç æ ¼å¼åŒ–
   - Vitestæµ‹è¯•æ¡†æ¶
   - Husky Gité’©å­
   - è‡ªåŠ¨åŒ–åŒ…åˆ›å»ºè„šæœ¬

4. **äº¤äº’å¼è„šæœ¬ç®¡ç†**
   - ç»Ÿä¸€çš„äº¤äº’å¼è„šæœ¬ç®¡ç†å™¨
   - å¤§å¹…ç®€åŒ–package.jsonè„šæœ¬ï¼ˆå‡å°‘68%ï¼‰
   - å‹å¥½çš„ç”¨æˆ·ç•Œé¢

5. **ç¯å¢ƒç®¡ç†**
   - å¤šç¯å¢ƒé…ç½®æ”¯æŒ
   - ç¯å¢ƒå˜é‡éªŒè¯
   - æ™ºèƒ½åŠ è½½æœºåˆ¶

6. **ç±»å‹ç”Ÿæˆç³»ç»Ÿ**
   - å®Œæ•´çš„TypeScriptç±»å‹ç”Ÿæˆå·¥å…·é“¾
   - æ”¯æŒå¤šç§æ•°æ®æº
   - è‡ªåŠ¨åŒ–ç±»å‹ç”Ÿæˆ

7. **ç›‘æ§å’Œå¤‡ä»½**
   - æ€§èƒ½ç›‘æ§å·¥å…·
   - å¤‡ä»½å›æ»šåŠŸèƒ½
   - å®‰å…¨æ‰«æ

8. **ç‰ˆæœ¬ç®¡ç†**
   - Changesetsé…ç½®
   - è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶

### ğŸ“ é¡¹ç›®ç»“æ„

```
imtp/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒåŠŸèƒ½åŒ…
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”‚   â””â”€â”€ vitest.config.ts
â”‚   â”œâ”€â”€ data/               # æ•°æ®å¤„ç†åŒ…
â”‚   â”œâ”€â”€ types/              # ç±»å‹å®šä¹‰åŒ…
â”‚   â”œâ”€â”€ ui/                 # UIç»„ä»¶åŒ…
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°åŒ…
â”‚   â”œâ”€â”€ example-package/    # ç¤ºä¾‹åŒ…
â”‚   â””â”€â”€ test-package/       # æµ‹è¯•åŒ…
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ interactive.js      # äº¤äº’å¼è„šæœ¬ç®¡ç†å™¨
â”‚   â”œâ”€â”€ dev-tools.js        # å¼€å‘å·¥å…·é›†
â”‚   â”œâ”€â”€ create-package.js   # åŒ…åˆ›å»ºè„šæœ¬
â”‚   â”œâ”€â”€ dependency-manager.js # ä¾èµ–ç®¡ç†
â”‚   â”œâ”€â”€ env-manager.js      # ç¯å¢ƒç®¡ç†
â”‚   â”œâ”€â”€ monitor.js          # æ€§èƒ½ç›‘æ§
â”‚   â”œâ”€â”€ rollback.js         # å¤‡ä»½å›æ»š
â”‚   â””â”€â”€ generate-types.js   # ç±»å‹ç”Ÿæˆ
â”œâ”€â”€ config/
â”‚   â””â”€â”€ env.ts              # ç¯å¢ƒé…ç½®
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ tsconfig.lib.json   # åº“TypeScripté…ç½®
â”‚   â”œâ”€â”€ vite.lib.config.ts  # åº“Viteé…ç½®
â”‚   â””â”€â”€ vitest.config.ts    # æµ‹è¯•é…ç½®
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ env-usage.ts        # ç¯å¢ƒä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ package.json            # æ ¹é…ç½®
â”œâ”€â”€ pnpm-workspace.yaml     # pnpmå·¥ä½œåŒºé…ç½®
â”œâ”€â”€ tsconfig.json           # TypeScripté…ç½®
â”œâ”€â”€ vite.config.ts          # Viteé…ç½®
â”œâ”€â”€ vitest.config.ts        # æµ‹è¯•é…ç½®
â”œâ”€â”€ eslint.config.js        # ESLinté…ç½®
â”œâ”€â”€ .prettierrc             # Prettieré…ç½®
â”œâ”€â”€ .changeset/             # Changesetsé…ç½®
â”œâ”€â”€ .husky/                 # Gité’©å­é…ç½®
â”œâ”€â”€ .gitignore              # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

### ğŸš€ å¿«é€Ÿå¼€å§‹

1. **å®‰è£…ä¾èµ–**

   ```bash
   pnpm install
   ```

2. **å¯åŠ¨äº¤äº’å¼å·¥å…·ï¼ˆæ¨èï¼‰**

   ```bash
   pnpm interactive
   ```

3. **å¼€å‘æ¨¡å¼**

   ```bash
   pnpm dev
   ```

4. **æ„å»ºæ‰€æœ‰åŒ…**

   ```bash
   pnpm build
   ```

5. **è¿è¡Œæµ‹è¯•**

   ```bash
   pnpm test
   ```

6. **ä»£ç æ£€æŸ¥**
   ```bash
   pnpm lint
   ```

### ğŸ“¦ åˆ›å»ºæ–°åŒ…

ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬åˆ›å»ºæ–°åŒ…ï¼š

```bash
# ä½¿ç”¨äº¤äº’å¼å·¥å…·
pnpm interactive
# é€‰æ‹©å¼€å‘å·¥å…· -> åˆ›å»ºæ–°åŒ…

# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤
node scripts/create-package.js <package-name>
```

ä¾‹å¦‚ï¼š

```bash
node scripts/create-package.js components
node scripts/create-package.js hooks
node scripts/create-package.js types
```

### ğŸ”§ ç¯å¢ƒç®¡ç†

```bash
# ä½¿ç”¨äº¤äº’å¼å·¥å…·
pnpm interactive
# é€‰æ‹©ç¯å¢ƒç®¡ç†

# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤
pnpm env:create development
pnpm env:create production
pnpm env:create test
pnpm env:validate
pnpm env:check
```

### ğŸ“Š ç±»å‹ç”Ÿæˆ

```bash
# ä½¿ç”¨äº¤äº’å¼å·¥å…·
pnpm interactive
# é€‰æ‹©ç”Ÿæˆå·¥å…·

# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤
pnpm generate:all
pnpm generate:types
pnpm generate:api
pnpm generate:graphql
```

### ğŸ“ˆ ç›‘æ§å’Œå¤‡ä»½

```bash
# ä½¿ç”¨äº¤äº’å¼å·¥å…·
pnpm interactive
# é€‰æ‹©ç›‘æ§ç®¡ç†æˆ–å¤‡ä»½ç®¡ç†

# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤
node scripts/monitor.js build
node scripts/monitor.js test
node scripts/monitor.js security
node scripts/rollback.js create
node scripts/rollback.js list
```

### ğŸ“‹ ä¸‹ä¸€æ­¥å»ºè®®

1. **é…ç½®npmç»„ç»‡**
   - åœ¨npmä¸Šåˆ›å»º`@imtp`ç»„ç»‡
   - é…ç½®å‘å¸ƒæƒé™

2. **æ·»åŠ CI/CD**
   - é…ç½®GitHub Actions
   - è‡ªåŠ¨åŒ–æµ‹è¯•å’Œå‘å¸ƒ

3. **å®Œå–„æ–‡æ¡£**
   - ä¸ºæ¯ä¸ªåŒ…ç¼–å†™è¯¦ç»†æ–‡æ¡£
   - æ·»åŠ ä½¿ç”¨ç¤ºä¾‹

4. **ä»£ç è´¨é‡**
   - é…ç½®Prettier
   - æ·»åŠ Huskyé’©å­
   - é…ç½®æäº¤è§„èŒƒ

### ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åŒ…ç®¡ç†å™¨**: pnpm
- **æ„å»ºå·¥å…·**: Vite
- **è¯­è¨€**: TypeScript
- **æµ‹è¯•**: Vitest
- **ä»£ç æ£€æŸ¥**: ESLint
- **ä»£ç æ ¼å¼åŒ–**: Prettier
- **ç‰ˆæœ¬ç®¡ç†**: Changesets
- **å·¥ä½œåŒº**: pnpm workspaces
- **Gité’©å­**: Husky
- **ç±»å‹ç”Ÿæˆ**: TypeDoc, OpenAPI TypeScript, GraphQL Code Generator

### ğŸ“ æ³¨æ„äº‹é¡¹

1. æ‰€æœ‰åŒ…éƒ½ä½¿ç”¨`@imtp/`å‰ç¼€
2. åŒ…ååªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—å’Œè¿å­—ç¬¦
3. æ¯ä¸ªåŒ…éƒ½åº”è¯¥æœ‰å®Œæ•´çš„æµ‹è¯•è¦†ç›–
4. éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ
5. ä½¿ç”¨äº¤äº’å¼å·¥å…·ç®€åŒ–æ“ä½œ

### ğŸ¯ é¡¹ç›®ä¼˜åŠ¿

- **ç°ä»£åŒ–æ¶æ„**: ä½¿ç”¨æœ€æ–°çš„æ„å»ºå·¥å…·å’ŒæŠ€æœ¯æ ˆ
- **å®Œæ•´å·¥å…·é“¾**: ä»å¼€å‘åˆ°éƒ¨ç½²çš„å…¨æµç¨‹æ”¯æŒ
- **äº¤äº’å¼ç®¡ç†**: å¤§å¹…ç®€åŒ–æ“ä½œå¤æ‚åº¦
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„TypeScriptæ”¯æŒ
- **è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜**: å‡å°‘æ‰‹åŠ¨æ“ä½œï¼Œæé«˜æ•ˆç‡
- **å¯æ‰©å±•æ€§å¼º**: æ˜“äºæ·»åŠ æ–°åŠŸèƒ½å’ŒåŒ…

---

ğŸŠ **æ­å–œï¼æ‚¨çš„ç°ä»£åŒ–npmåŒ…å¼€å‘ç¯å¢ƒå·²ç»å‡†å¤‡å°±ç»ªï¼**

ç°åœ¨æ‚¨å¯ä»¥ï¼š

- ä½¿ç”¨ `pnpm interactive` å¯åŠ¨äº¤äº’å¼å·¥å…·
- ä½¿ç”¨ `node scripts/create-package.js <name>` åˆ›å»ºæ–°åŒ…
- ä½¿ç”¨ `pnpm generate:all` ç”Ÿæˆç±»å‹
- ä½¿ç”¨ `node scripts/monitor.js` ç›‘æ§æ€§èƒ½
- äº«å—ç°ä»£åŒ–çš„å¼€å‘ä½“éªŒï¼
