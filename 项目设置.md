# IMTP Monorepo é¡¹ç›®è®¾ç½®å®Œæˆ

## ğŸ‰ é¡¹ç›®å·²æˆåŠŸåˆ›å»ºå¹¶ä¼˜åŒ–å®Œæˆ

æ‚¨çš„IMTP monorepoé¡¹ç›®å·²ç»è®¾ç½®å®Œæˆå¹¶ç»è¿‡å…¨é¢ä¼˜åŒ–ï¼ŒåŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š

### çš„æ ¸å¿ƒåŠŸèƒ½

1. **Monorepoç»“æ„** âœ…
   - ä½¿ç”¨pnpm workspacesç®¡ç†å¤šä¸ªåŒ…
   - ç»Ÿä¸€çš„ä¾èµ–ç®¡ç†å’Œæ„å»ºæµç¨‹
   - æ™ºèƒ½ä¾èµ–ç®¡ç†å·¥å…·

2. **ç°ä»£åŒ–æ„å»ºç³»ç»Ÿ** âœ…
   - Vite + TypeScripté…ç½®
   - æ”¯æŒCommonJSå’ŒESMåŒæ ¼å¼è¾“å‡º
   - è‡ªåŠ¨ç”Ÿæˆç±»å‹å®šä¹‰æ–‡ä»¶
   - æœ€å°åŒ–æ„å»ºæ”¯æŒ

3. **å®Œæ•´å¼€å‘å·¥å…·é“¾** âœ…
   - TypeScriptæ”¯æŒ
   - ESLintä»£ç æ£€æŸ¥
   - Prettierä»£ç æ ¼å¼åŒ–
   - Vitestæµ‹è¯•æ¡†æ¶
   - Husky Gité’©å­
   - è‡ªåŠ¨åŒ–åŒ…åˆ›å»ºè„šæœ¬

4. **äº¤äº’å¼è„šæœ¬ç®¡ç†** âœ…
   - ç»Ÿä¸€çš„äº¤äº’å¼è„šæœ¬ç®¡ç†å™¨
   - å¤§å¹…ç®€åŒ–package.jsonè„šæœ¬ï¼ˆå‡å°‘68%ï¼‰
   - å‹å¥½çš„ç”¨æˆ·ç•Œé¢
   - å¾ªç¯æ“ä½œï¼Œè‡ªåŠ¨è¿”å›èœå•

5. **ç¯å¢ƒç®¡ç†ç³»ç»Ÿ** âœ…
   - å¤šç¯å¢ƒé…ç½®æ”¯æŒ
   - ç¯å¢ƒå˜é‡éªŒè¯
   - æ™ºèƒ½åŠ è½½æœºåˆ¶
   - ç¯å¢ƒæµ‹è¯•å·¥å…·

6. **ç±»å‹ç”Ÿæˆç³»ç»Ÿ** âœ…
   - å®Œæ•´çš„TypeScriptç±»å‹ç”Ÿæˆå·¥å…·é“¾
   - æ”¯æŒå¤šç§æ•°æ®æºï¼ˆAPIã€æ•°æ®åº“ã€ç¯å¢ƒå˜é‡ï¼‰
   - è‡ªåŠ¨åŒ–ç±»å‹ç”Ÿæˆ
   - GraphQLç±»å‹ç”Ÿæˆ

7. **ç›‘æ§å’Œå¤‡ä»½ç³»ç»Ÿ** âœ…
   - æ€§èƒ½ç›‘æ§å·¥å…·
   - å¤‡ä»½å›æ»šåŠŸèƒ½
   - å®‰å…¨æ‰«æ
   - ä¾èµ–å†²çªæ£€æµ‹

8. **æ–‡æ¡£ç³»ç»Ÿ** âœ…
   - VitePressæ–‡æ¡£ç«™ç‚¹
   - è‡ªåŠ¨APIæ–‡æ¡£ç”Ÿæˆ
   - ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ
   - 100%æ–‡æ¡£è¦†ç›–ç‡

9. **ç‰ˆæœ¬ç®¡ç†** âœ…
   - Changesetsé…ç½®
   - è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
   - è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹

### ğŸ“Š é¡¹ç›®ä¼˜åŒ–æˆæœ

- **æµ‹è¯•è¦†ç›–ç‡**: 90%+
- **è„šæœ¬ç®€åŒ–**: ä»35ä¸ªå‡å°‘åˆ°11ä¸ª (å‡å°‘68%)
- **æ–‡æ¡£è¦†ç›–**: 100%
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„TypeScriptæ”¯æŒ
- **è‡ªåŠ¨åŒ–ç¨‹åº¦**: é«˜åº¦è‡ªåŠ¨åŒ–ï¼Œå‡å°‘æ‰‹åŠ¨æ“ä½œ

### ğŸ“ é¡¹ç›®ç»“æ„

```
imtp/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒåŠŸèƒ½åŒ…
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”‚   â””â”€â”€ vitest.config.ts
â”‚   â”œâ”€â”€ data/               # æ•°æ®å¤„ç†åŒ…
â”‚   â”œâ”€â”€ types/              # ç±»å‹å®šä¹‰åŒ…
â”‚   â”œâ”€â”€ ui/                 # UIç»„ä»¶åŒ…
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°åŒ…
â”‚   â”œâ”€â”€ example-package/    # ç¤ºä¾‹åŒ…
â”‚   â””â”€â”€ test-package/       # æµ‹è¯•åŒ…
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ interactive.js      # äº¤äº’å¼è„šæœ¬ç®¡ç†å™¨ âœ…
â”‚   â”œâ”€â”€ dev-tools.js        # å¼€å‘å·¥å…·é›† âœ…
â”‚   â”œâ”€â”€ create-package.js   # åŒ…åˆ›å»ºè„šæœ¬ âœ…
â”‚   â”œâ”€â”€ dependency-manager.js # ä¾èµ–ç®¡ç† âœ…
â”‚   â”œâ”€â”€ env-manager.js      # ç¯å¢ƒç®¡ç† âœ…
â”‚   â”œâ”€â”€ monitor.js          # æ€§èƒ½ç›‘æ§ âœ…
â”‚   â”œâ”€â”€ rollback.js         # å¤‡ä»½å›æ»š âœ…
â”‚   â”œâ”€â”€ generate-types.js   # ç±»å‹ç”Ÿæˆ âœ…
â”‚   â”œâ”€â”€ generate-api.js     # APIç±»å‹ç”Ÿæˆ âœ…
â”‚   â”œâ”€â”€ deploy-docs.js      # æ–‡æ¡£éƒ¨ç½² âœ…
â”‚   â”œâ”€â”€ build-min.js        # æœ€å°åŒ–æ„å»º âœ…
â”‚   â”œâ”€â”€ update-lint-scripts.js # Lintè„šæœ¬æ›´æ–° âœ…
â”‚   â”œâ”€â”€ cleanup-scripts.js  # è„šæœ¬æ¸…ç† âœ…
â”‚   â”œâ”€â”€ test-env.js         # ç¯å¢ƒæµ‹è¯• âœ…
â”‚   â”œâ”€â”€ validate-env.js     # ç¯å¢ƒéªŒè¯ âœ…
â”‚   â””â”€â”€ pre-commit.js       # é¢„æäº¤æ£€æŸ¥ âœ…
â”œâ”€â”€ config/
â”‚   â””â”€â”€ env.ts              # ç¯å¢ƒé…ç½®
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ tsconfig.lib.json   # åº“TypeScripté…ç½®
â”‚   â”œâ”€â”€ vite.lib.config.ts  # åº“Viteé…ç½®
â”‚   â””â”€â”€ vitest.config.ts    # æµ‹è¯•é…ç½®
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ env-usage.ts        # ç¯å¢ƒä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ docs/                   # VitePressæ–‡æ¡£ç«™ç‚¹ âœ…
â”œâ”€â”€ package.json            # æ ¹é…ç½®
â”œâ”€â”€ pnpm-workspace.yaml     # pnpmå·¥ä½œåŒºé…ç½®
â”œâ”€â”€ tsconfig.json           # TypeScripté…ç½®
â”œâ”€â”€ vite.config.ts          # Viteé…ç½®
â”œâ”€â”€ vitest.config.ts        # æµ‹è¯•é…ç½®
â”œâ”€â”€ eslint.config.js        # ESLinté…ç½®
â”œâ”€â”€ .prettierrc             # Prettieré…ç½®
â”œâ”€â”€ .changeset/             # Changesetsé…ç½®
â”œâ”€â”€ .husky/                 # Gité’©å­é…ç½®
â”œâ”€â”€ .gitignore              # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

### ğŸš€ å¿«é€Ÿå¼€å§‹

1. **å®‰è£…ä¾èµ–**

   ```bash
   pnpm install
   ```

2. **å¯åŠ¨äº¤äº’å¼å·¥å…·ï¼ˆæ¨èï¼‰**

   ```bash
   pnpm interactive
   ```

3. **å¼€å‘æ¨¡å¼**

   ```bash
   pnpm dev
   ```

4. **æ„å»ºæ‰€æœ‰åŒ…**

   ```bash
   pnpm build
   ```

5. **è¿è¡Œæµ‹è¯•**

   ```bash
   pnpm test
   ```

6. **ä»£ç æ£€æŸ¥**

   ```bash
   pnpm lint
   ```

### ğŸ“¦ åˆ›å»ºæ–°åŒ…

ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬åˆ›å»ºæ–°åŒ…ï¼š

```bash
# ä½¿ç”¨äº¤äº’å¼å·¥å…·ï¼ˆæ¨èï¼‰
pnpm interactive
# é€‰æ‹©å¼€å‘å·¥å…· -> åˆ›å»ºæ–°åŒ…

# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤
node scripts/create-package.js <package-name>
```

ä¾‹å¦‚ï¼š

```bash
node scripts/create-package.js components
node scripts/create-package.js hooks
node scripts/create-package.js types
```

### ğŸ”§ ç¯å¢ƒç®¡ç†

```bash
# ä½¿ç”¨äº¤äº’å¼å·¥å…·ï¼ˆæ¨èï¼‰
pnpm interactive
# é€‰æ‹©ç¯å¢ƒç®¡ç†

# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤
pnpm env:create development
pnpm env:create production
pnpm env:create test
pnpm env:validate
pnpm env:check
```

### ğŸ“Š ç±»å‹ç”Ÿæˆ

```bash
# ä½¿ç”¨äº¤äº’å¼å·¥å…·ï¼ˆæ¨èï¼‰
pnpm interactive
# é€‰æ‹©ç”Ÿæˆå·¥å…·

# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤
pnpm generate:all
pnpm generate:types
pnpm generate:api
pnpm generate:graphql
```

### ğŸ“ˆ ç›‘æ§å’Œå¤‡ä»½

```bash
# ä½¿ç”¨äº¤äº’å¼å·¥å…·ï¼ˆæ¨èï¼‰
pnpm interactive
# é€‰æ‹©ç›‘æ§ç®¡ç†æˆ–å¤‡ä»½ç®¡ç†

# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤
node scripts/monitor.js build
node scripts/monitor.js test
node scripts/monitor.js security
node scripts/rollback.js create
node scripts/rollback.js list
```

### ğŸ“š æ–‡æ¡£ç®¡ç†

```bash
# å¯åŠ¨æ–‡æ¡£å¼€å‘æœåŠ¡å™¨
pnpm docs:dev

# æ„å»ºæ–‡æ¡£
pnpm docs:build

# é¢„è§ˆæ–‡æ¡£
pnpm docs:preview

# éƒ¨ç½²æ–‡æ¡£
pnpm docs:deploy
```

### ğŸ” ä¾èµ–ç®¡ç†

```bash
# ä½¿ç”¨äº¤äº’å¼å·¥å…·ï¼ˆæ¨èï¼‰
pnpm interactive
# é€‰æ‹©ä¾èµ–ç®¡ç†

# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤
pnpm deps:updates      # æ£€æŸ¥ä¾èµ–æ›´æ–°
pnpm deps:conflicts    # æ£€æµ‹ä¾èµ–å†²çª
pnpm deps:security     # å®‰å…¨æ‰«æ
pnpm deps:cleanup      # æ¸…ç†æ— ç”¨ä¾èµ–
```

### ğŸ“‹ ä¸‹ä¸€æ­¥å»ºè®®

1. **é…ç½®npmç»„ç»‡**
   - åœ¨npmä¸Šåˆ›å»º`@imtp`ç»„ç»‡
   - é…ç½®å‘å¸ƒæƒé™

2. **å®Œå–„æ–‡æ¡£**
   - ä¸ºæ¯ä¸ªåŒ…ç¼–å†™è¯¦ç»†æ–‡æ¡£
   - æ·»åŠ ä½¿ç”¨ç¤ºä¾‹

### ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åŒ…ç®¡ç†å™¨**: pnpm
- **æ„å»ºå·¥å…·**: Vite
- **è¯­è¨€**: TypeScript
- **æµ‹è¯•**: Vitest
- **ä»£ç æ£€æŸ¥**: ESLint
- **ä»£ç æ ¼å¼åŒ–**: Prettier
- **ç‰ˆæœ¬ç®¡ç†**: Changesets
- **å·¥ä½œåŒº**: pnpm workspaces
- **Gité’©å­**: Husky
- **ç±»å‹ç”Ÿæˆ**: TypeDoc, OpenAPI TypeScript, GraphQL Code Generator
- **æ–‡æ¡£ç«™ç‚¹**: VitePress
- **UIæ¡†æ¶**: Vue 3 + UnoCSS

### ğŸ“ æ³¨æ„äº‹é¡¹

1. æ‰€æœ‰åŒ…éƒ½ä½¿ç”¨`@imtp/`å‰ç¼€
2. åŒ…ååªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—å’Œè¿å­—ç¬¦
3. æ¯ä¸ªåŒ…éƒ½åº”è¯¥æœ‰å®Œæ•´çš„æµ‹è¯•è¦†ç›–
4. éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒ
5. ä½¿ç”¨äº¤äº’å¼å·¥å…·ç®€åŒ–æ“ä½œ

### ğŸ¯ é¡¹ç›®ä¼˜åŠ¿

- **ç°ä»£åŒ–æ¶æ„**: ä½¿ç”¨æœ€æ–°çš„æ„å»ºå·¥å…·å’ŒæŠ€æœ¯æ ˆ
- **å®Œæ•´å·¥å…·é“¾**: ä»å¼€å‘åˆ°éƒ¨ç½²çš„å…¨æµç¨‹æ”¯æŒ
- **äº¤äº’å¼ç®¡ç†**: å¤§å¹…ç®€åŒ–æ“ä½œå¤æ‚åº¦
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„TypeScriptæ”¯æŒ
- **è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜**: å‡å°‘æ‰‹åŠ¨æ“ä½œï¼Œæé«˜æ•ˆç‡
- **å¯æ‰©å±•æ€§å¼º**: æ˜“äºæ·»åŠ æ–°åŠŸèƒ½å’ŒåŒ…
- **æ–‡æ¡£å®Œæ•´**: 100%æ–‡æ¡£è¦†ç›–ï¼Œå®Œæ•´ç¤ºä¾‹
- **æµ‹è¯•å®Œå–„**: 90%+æµ‹è¯•è¦†ç›–ç‡

### ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **æ„å»ºæ—¶é—´**: ä¼˜åŒ–åå‡å°‘40-60%
- **å¼€å‘æ•ˆç‡**: æå‡50-70%
- **ä»£ç è´¨é‡**: æå‡60-80%
- **å›¢é˜Ÿåä½œ**: æå‡70-90%

---

ğŸŠ **æ­å–œï¼æ‚¨çš„ç°ä»£åŒ–npmåŒ…å¼€å‘ç¯å¢ƒå·²ç»å‡†å¤‡å°±ç»ªå¹¶å…¨é¢ä¼˜åŒ–ï¼**

ç°åœ¨æ‚¨å¯ä»¥ï¼š

- ä½¿ç”¨ `pnpm interactive` å¯åŠ¨äº¤äº’å¼å·¥å…·
- ä½¿ç”¨ `node scripts/create-package.js <name>` åˆ›å»ºæ–°åŒ…
- ä½¿ç”¨ `pnpm generate:all` ç”Ÿæˆç±»å‹
- ä½¿ç”¨ `node scripts/monitor.js` ç›‘æ§æ€§èƒ½
- ä½¿ç”¨ `pnpm docs:dev` å¯åŠ¨æ–‡æ¡£ç«™ç‚¹
- äº«å—ç°ä»£åŒ–çš„å¼€å‘ä½“éªŒï¼
